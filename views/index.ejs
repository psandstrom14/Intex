<!--
    index.ejs - Home Page
    Paris Ward, Lucas Moraes, Joshua Ethington, Parker Sandstrom
    
    This is the main landing page for Ella Rises. It introduces the organization,
    shows programs, impact stats, and has calls to action. The navigation changes
    based on whether someone is logged in and what their role is.
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home - Ella Rises</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="icon" type="image/x-icon" href="/logo.ico" />
</head>
<body>
    <!-- Skip Navigation Link - helps screen readers skip to main content -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- 
        Navigation Bar - Shows different links based on login status and role
        The server passes isLoggedIn, userId, and role variables to this template
    -->
    <nav>
        <div class="nav-container">
            <div class="logo">
                <a href="/"><img src="/images/logo.png" alt="Ella Rises Logo"> ELLA RISES</a>
            </div>
            <ul class="nav-links">
                <!-- Public navigation links - everyone sees these -->
                <li><a href="/" class="selected-nav" >Home</a></li>
                <li><a href="/about">About</a></li>
                <li><a href="/calendar">Calendar</a></li>
                <li><a href="/donate_now">Donate Now</a></li>

                <!-- Profile link - only shows if user is logged in -->
                <% if (isLoggedIn && userId) { %>
                    <li><a href="/profile/<%= userId %>">Profile</a></li>
                <% } %>

                <!-- Admin dropdown menu - only admins see this "Pages" dropdown -->
                <!-- This gives admins access to all the database management pages -->
                <% if (role === "admin") { %>
                    <li class="dropdown">
                        <span class="dropdown-toggle">
                            <a href="#">Pages ‚ñæ</a>
                        </span>
                        <ul class="dropdown-menu">
                            <li><a href="/participants">Participants</a></li>
                            <li><a href="/users">Users</a></li>
                            <li><a href="/events">Events</a></li>
                            <li><a href="/event_registrations">Event Registrations</a></li>
                            <li><a href="/surveys">Surveys</a></li>
                            <li><a href="/milestones">Milestones</a></li>
                            <li><a href="/donations">Donations</a></li>
                        </ul>
                    </li>
                <% } %>

                <!-- Login/Logout button - changes based on login status -->
                <% if (isLoggedIn) { %>
                    <li><a href="/logout" class="login-btn">Logout</a></li>
                <% } else { %>
                    <li><a href="/login" class="login-btn">Login</a></li>
                <% } %>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
        <h1>Empowering Women, Transforming Lives</h1>
        <p>
            Inviting young women to pursue higher education and embrace their
            heritage by providing culturally rooted programs and educational
            experiences.
            </p>
            <a href="/donate_now" class="btn btn-primary donate-btn">Donate Now</a>
        </div>
        </section>

        <!-- What We Do Section -->
        <main id="main-content">
        <section class="container mt-4">
        <h2 class="text-center home-section-heading">What We Do</h2>
        <p class="text-center text-muted mb-4 home-section-subtitle">
            Our programs and initiatives make a real difference in women's lives
        </p>

        <div class="grid grid-3">
            <div class="card">
            <div class="card-header">
                <h3 class="card-title">Education & Skills Training</h3>
            </div>
            <div class="card-body">
                <p>
                We provide access to educational resources, vocational training,
                and skill development programs to help women achieve economic
                independence and career success.
                </p>
            </div>
            </div>

            <div class="card">
            <div class="card-header">
                <h3 class="card-title">Career Support</h3>
            </div>
            <div class="card-body">
                <p>
                Our mentorship programs connect women with industry professionals,
                offering guidance, networking opportunities, and pathways to
                meaningful employment.
                </p>
            </div>
            </div>

            <div class="card">
            <div class="card-header">
                <h3 class="card-title">Community Building</h3>
            </div>
            <div class="card-body">
                <p>
                We foster supportive communities where women can connect, share
                experiences, and find encouragement through workshops, events, and
                support groups.
                </p>
            </div>
            </div>
        </div>
        </section>

        <!-- Programs Section -->
        <section class="container mt-4">
        <h2 class="text-center home-section-heading">Our Programs</h2>
        <p class="text-center text-muted mb-4 home-section-subtitle">
            Culturally rooted programs that empower and inspire
        </p>

        <div class="grid grid-2 home-programs-grid-top">
            <div class="card home-program-card">
            <div
                class="home-program-image-container"
                style="background-image: url('/images/Summer_Summit.jpg')"
            ></div>
            <div class="card-header">
                <h3 class="card-title">Summit + Educational Pathways</h3>
            </div>
            <div class="card-body">
                <p>
                Our educational pathways program provides comprehensive support
                for young women pursuing higher education, including mentorship,
                resources, and opportunities to connect with educational leaders
                and institutions.
                </p>
            </div>
            </div>

            <div class="card home-program-card">
            <div
                class="home-program-image-container"
                style="background-image: url('/images/Steam.png')"
            ></div>
            <div class="card-header">
                <h3 class="card-title">STEAM</h3>
            </div>
            <div class="card-body">
                <p>
                Our STEAM (Science, Technology, Engineering, Arts, and
                Mathematics) program engages young women in hands-on learning
                experiences, building confidence and skills in these critical
                fields through interactive workshops and projects.
                </p>
            </div>
            </div>
        </div>

        <div class="grid grid-2 home-programs-grid-bottom">
            <div class="card home-program-card">
            <div
                class="home-program-image-container"
                style="background-image: url('/images/Mariachi_Single.png')"
            ></div>
            <div class="card-header">
                <h3 class="card-title">Mariachi</h3>
            </div>
            <div class="card-body">
                <p>
                Celebrate and preserve cultural heritage through our mariachi
                program, where young women learn traditional music, build
                confidence, and connect with their roots.
                </p>
            </div>
            </div>

            <div class="card home-program-card">
            <div
                class="home-program-image-container"
                style="background-image: url('/images/Dancing.png')"
            ></div>
            <div class="card-header">
                <h3 class="card-title">Ballet Folklorico</h3>
            </div>
            <div class="card-body">
                <p>
                Our ballet folklorico program teaches traditional dance, fostering
                cultural pride, physical fitness, and artistic expression among
                participants.
                </p>
            </div>
            </div>
        </div>
        </section>
        
        <!-- Stats Section -->
        <section class="container mt-4">
            <h2 class="text-center home-section-heading">Our Impact</h2>
            <p class="text-center text-muted mb-4 home-section-subtitle">
                Together, we're making a difference
            </p>
    
            <div class="stats-grid">
                <div class="stat-card">
                <div class="stat-number">600+</div>
                <div class="stat-label">Women Empowered</div>
                </div>
    
                <div class="stat-card">
                <div class="stat-number">1,400+</div>
                <div class="stat-label">Events Hosted</div>
                </div>
    
                <div class="stat-card">
                <div class="stat-number">15</div>
                <div class="stat-label">Programs Offered</div>
                </div>
    
                <div class="stat-card">
                <div class="stat-number">10+</div>
                <div class="stat-label">Partner Organizations</div>
                </div>
            </div>
            </section>    

        <!-- Enrollment Section -->
        <section class="home-enrollment-section">
        <div class="home-enrollment-content">
            <h2 class="home-enrollment-heading">Enroll in Ella Rises</h2>
            <p class="home-enrollment-text">
            Enroll in Ella Rises and participate in our mariachi, ballet
            folklorico and STEAM programs!
            </p>
            <a href="/" class="btn btn-primary btn-large btn-charcoal">
            Click here to enroll!
            </a>
        </div>
        </section>

        <!-- Sponsorship Section -->
        <section class="container mt-4 home-sponsorship-section">
        <div class="home-sponsorship-content">
            <div class="home-sponsorship-buttons">
            <img
                src="/images/left_orange.png"
                alt=""
                class="home-sponsorship-flower"
                aria-hidden="true"
            />
            <a href="/donate_now" class="btn btn-primary btn-large btn-charcoal">
                Become a sponsor!
            </a>
            <img
                src="/images/right_red.png"
                alt=""
                class="home-sponsorship-flower"
                aria-hidden="true"
            />
            </div>
            <p class="home-sponsorship-text">
            If you would like to further discuss how you would like to contribute,
            please email
            <a href="mailto:nadia@ellarises.org" class="home-sponsorship-email"
                >nadia@ellarises.org</a
            >.
            </p>
            <p class="home-sponsorship-thanks">¬°Muchas gracias!</p>
        </div>
        </section>
        </main>
        
        <!--Footer-->
    <footer>
        <p>&copy; 2025 Ella Rises. All Rights Reserved.</p>
        <p class="footer-subtext">Making a difference, one woman at a time.</p>

        <div class="custom-language-selector">
            <button class="language-dropdown-btn" onclick="toggleLanguageDropdown()">
                <span id="currentLanguage">
                    <% if (language === 'es') { %>üåê Espa√±ol
                    <% } else if (language === 'fr') { %>üåê Fran√ßais
                    <% } else if (language === 'de') { %>üåê Deutsch
                    <% } else if (language === 'pt') { %>üåê Portugu√™s
                    <% } else if (language === 'ar') { %>üåê ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
                    <% } else if (language === 'zh-CN') { %>üåê ‰∏≠Êñá
                    <% } else if (language === 'ja') { %>üåê Êó•Êú¨Ë™û
                    <% } else if (language === 'ko') { %>üåê ÌïúÍµ≠Ïñ¥
                    <% } else { %>üåê English <% } %>
                </span>
                <span class="dropdown-arrow">‚ñæ</span>
            </button>
            <div class="language-dropdown-menu" id="languageDropdown">
                <a href="#" onclick="changeLanguage('en'); return false;">English</a>
                <a href="#" onclick="changeLanguage('es'); return false;">Espa√±ol</a>
                <a href="#" onclick="changeLanguage('fr'); return false;">Fran√ßais</a>
                <a href="#" onclick="changeLanguage('de'); return false;">Deutsch</a>
                <a href="#" onclick="changeLanguage('pt'); return false;">Portugu√™s</a>
                <a href="#" onclick="changeLanguage('ar'); return false;">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</a>
                <a href="#" onclick="changeLanguage('zh-CN'); return false;">‰∏≠Êñá</a>
                <a href="#" onclick="changeLanguage('ja'); return false;">Êó•Êú¨Ë™û</a>
                <a href="#" onclick="changeLanguage('ko'); return false;">ÌïúÍµ≠Ïñ¥</a>
            </div>
        </div>

        <div id="google_translate_element" style="display:none;"></div>

        <!-- 
            Language Selection Script
            This handles the multi-language support using Google Translate.
            When users select a language, we save it to their session so it persists
            across page visits. The language preference comes from:
            1. Google Translate cookie (if they used Google's widget)
            2. Server session (if they used our custom dropdown)
            3. Browser localStorage (backup)
            4. Default to English
        -->
        <script>
            // Map of language codes to display names
            const LANGUAGE_NAMES = {
                'en': 'üåê English',
                'es': 'üåê Espa√±ol',
                'fr': 'üåê Fran√ßais',
                'de': 'üåê Deutsch',
                'pt': 'üåê Portugu√™s',
                'ar': 'üåê ÿßŸÑÿπÿ±ÿ®Ÿäÿ©',
                'zh-CN': 'üåê ‰∏≠Êñá',
                'ja': 'üåê Êó•Êú¨Ë™û',
                'ko': 'üåê ÌïúÍµ≠Ïñ¥'
            };

            // Get the language from the server session (set by index.js middleware)
            const SESSION_LANGUAGE = '<%= language || "en" %>';

            // Initialize Google Translate widget - this loads Google's translation service
            function googleTranslateElementInit() {
                new google.translate.TranslateElement({
                    pageLanguage: 'en',
                    includedLanguages: 'en,es,fr,de,pt,ar,zh-CN,ja,ko',
                    autoDisplay: false // Don't show Google's default widget, we have our own
                }, 'google_translate_element');
            }

            // Check if Google Translate has set a cookie with language preference
            function getGoogTransLang() {
                // Looks for cookie like: googtrans=/auto/es
                const match = document.cookie.match(/(?:^|;)\s*googtrans=\/auto\/([^;]+)/);
                return match ? match[1] : null;
            }

            // Update the language dropdown label to show current language
            function setLanguageLabel(lang) {
                const el = document.getElementById('currentLanguage');
                if (!el) return;
                el.textContent = LANGUAGE_NAMES[lang] || LANGUAGE_NAMES['en'];
            }

            // Actually apply the language selection - tells Google Translate to translate the page
            function applyLanguage(lang, isInit) {
                const combo = document.querySelector('.goog-te-combo');
                if (!combo) {
                    // Google widget hasn't loaded yet, wait a bit and try again
                    setTimeout(() => applyLanguage(lang, isInit), 200);
                    return;
                }

                // Set the language in Google's widget
                combo.value = lang;
                combo.dispatchEvent(new Event('change'));
                setLanguageLabel(lang);

                if (!isInit) {
                    // User just changed language - save it to server session
                    fetch('/set-language', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ lang })
                    }).catch(() => {});
                    // Also save to browser storage as backup
                    localStorage.setItem('selectedLanguage', lang);
                    toggleLanguageDropdown(false);
                }
            }

            // Called when user clicks a language in the dropdown
            function changeLanguage(lang) {
                applyLanguage(lang, false);
            }

            // Show/hide the language dropdown menu
            function toggleLanguageDropdown(forceClose) {
                const dropdown = document.getElementById('languageDropdown');
                if (!dropdown) return;
                if (forceClose === false) {
                    dropdown.classList.remove('show');
                } else {
                    dropdown.classList.toggle('show');
                }
            }

            // Close dropdown if user clicks outside of it
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.custom-language-selector')) {
                    toggleLanguageDropdown(false);
                }
            });

            // When page loads, figure out what language to use
            document.addEventListener('DOMContentLoaded', () => {
                // Set the label to match what we think the language is
                setLanguageLabel(SESSION_LANGUAGE);

                const cookieLang = getGoogTransLang();
                const storedLang = localStorage.getItem('selectedLanguage');

                // Priority order: Google cookie > session > localStorage > English
                const preferred =
                    cookieLang ||
                    (SESSION_LANGUAGE && SESSION_LANGUAGE !== 'undefined' ? SESSION_LANGUAGE : null) ||
                    storedLang ||
                    'en';

                // If it's English, don't bother translating (avoids flicker)
                if (preferred === 'en') {
                    setLanguageLabel('en');
                    return;
                }

                // Apply the preferred language once Google's widget is ready
                setTimeout(() => applyLanguage(preferred, true), 500);
            });
        </script>

        <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    </footer>

        <script>
        // Allow Dropdown to handle delay to increase usability
        let dropdownTimeout;
        const dropdown = document.querySelector(".dropdown");
        const dropdownMenu = document.querySelector(".dropdown-menu");

        if (dropdown && dropdownMenu) {
            dropdown.addEventListener("mouseenter", function () {
            clearTimeout(dropdownTimeout);
            dropdownMenu.style.display = "block";
            });

            dropdown.addEventListener("mouseleave", function () {
            dropdownTimeout = setTimeout(function () {
                dropdownMenu.style.display = "none";
            }, 200); // 200ms delay before closing
            });

            dropdownMenu.addEventListener("mouseenter", function () {
            clearTimeout(dropdownTimeout);
            dropdownMenu.style.display = "block";
            });

            dropdownMenu.addEventListener("mouseleave", function () {
            dropdownTimeout = setTimeout(function () {
                dropdownMenu.style.display = "none";
            }, 200);
            });
        }
        </script>
    </body>
    </html>
